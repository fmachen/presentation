<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Brunch dans nos VZ</title>
        <meta name="description" content="Brunch dans nos VZ">
        <meta name="author" content="Florent Machen">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style"
              content="black-translucent" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0,
              maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/league.css" id="theme">

        <link rel="stylesheet" href="lib/css/zenburn.css">

        <script>
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match(/print-pdf/gi) ?
                    'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName('head')[0].appendChild(link);
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="reveal">

            <div class="slides">
                <section>
                    <h1>Brunch</h1>
                    <h3>Dans nos VZ</h3>
                    <p>
                        <small>Une présentation de <a href="#">Florent Machen</a> pour <a
                                href="http://www.recisio.com">Recisio</a> le 03/04/2014</small>
                    </p>
                </section>

                <section>
                    <h2>WhoAmI</h2>
                    <p class="fragment roll-in">Non je plaisante, je ne vais pas vous
                        faire le coup 2 fois de suite.</p>
                </section>

                <section>
                    <section>
                        <h2>Brunch ?! C'est quoi, Brunch ?</h2>
                        <ul>
                            <li class="fragment roll-in">Pas un repas :( !</li>
                            <li class="fragment roll-in">Pas un exécuteur de tâches (make,
                                ant, maven, rake ...)</li>
                            <li class="fragment roll-in">C'est un builder, son boulot :
                                <ul class="fragment roll-in">
                                    <li>Compilation des scripts et des styles</li>
                                    <li>Concaténation et minification</li>
                                    <li>Génération de source-maps</li>
                                    <li>Optimisation des images</li>
                                    <li>Et beaucoup d'autres tâches ... en rapport avec le WEB</li>
                                </ul>
                            </li>
                        </ul>
                        <p class="fragment roll-in">Automatise des tâches répétitives pour la production de fichiers finaux</p>
                    </section>
                    <section>
                        <h2>Il existe des alternatives</h2>
                        <ul>
                            <li>Grunt, Gulp (très connus)</li>
                            <li class="fragment roll-in">Broccoli, Glou (moins connus)</li>
                            <li class="fragment roll-in">Brunch (le top, sinon j'en montrerai un autre)
                                <ul class="fragment roll-in">
                                    <li>pourquoi ?
                                        <ul class="fragment roll-in">
                                            <li>pipelines (pas de fichiers intermédiaires)</li>
                                            <li>conventions (plutôt que configuration)</li>
                                            <li>builds incrémentaux (comment vivre sans)</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Installation</h2>
                        <p>Node.js <span class="fragment roll-in">(encore lui)</span></p>
                        <pre><code data-trim contenteditable>
npm install -g brunch
npm install
                        </code></pre>
                    </section>
                    <section>
                        <h2>Dans nos VZ ... C'est comment ?</h2>
                        <p>brunch tourne en permanence avec les modules présent dans package.json</p>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
brunch watch
                        </code></pre>
                        <p class="fragment roll-in">pour consulter l'historique</p>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
tail -f /var/log/brunch/brunch.weboffice.log
                        </code></pre>
                    </section>
                    <section>
                        <h2>On ne nous dit pas tout !</h2>
                        <p class="fragment roll-in">package.json</p>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
{
  "name": "simple-brunch",
  "version": "0.1.0",
  "private": true,
  "devDependencies": {
    "brunch": "~1.7.20",
    "javascript-brunch": "~1.7.1",
    "sass-brunch": "~1.8.9",
    "clean-css-brunch": "~1.7.2",
    "ngmin-uglify-js-brunch": "~1.7.13",
    "css-brunch": "~1.7.0",
    "sprite-brunch": "0.0.3"
  }
}
                        </code></pre>
                        <p class="fragment roll-in">on bourre le tout dans <em>«&nbsp;node_modules&nbsp;»</em></p>
                    </section>
                    <section>
                        <h2>Pro tips</h2>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
npm install --save nom-du-plugin
                        </code></pre>
                        <p class="fragment roll-in">chargé dans node_modules et mise à jour du package.json</p>
                    </section>
                    <section>
                        <h2>Convention et configuration</h2>
                        <ul class="fragment roll-in">
                            <li>
                                le dossier <em>«&nbsp;app&nbsp;»</em> contient les sources (CSS, JS, templates ...) propres à l'application <em>«&nbsp;à traiter&nbsp;»</em>
                                <strong class="fragment roll-in">paths.watched</strong>
                            </li>
                            <li>
                                le dossier <em>«&nbsp;vendor&nbsp;»</em> contient les sources (CSS, JS, templates ...) tierces <em>«&nbsp;à traiter&nbsp;»</em>
                                <strong class="fragment roll-in">conventions.vendor</strong>
                            </li>
                            <li>
                                les dossiers <em>«&nbsp;assets&nbsp;»</em> contient les sources utilisés <em>«&nbsp;sans traitement&nbsp;»</em>
                                <strong class="fragment roll-in">conventions.assets</strong>
                            </li>
                            <li>
                                un fichier commencant par <em>«&nbsp;_&nbsp;»</em> est ignoré (fichier partiel)
                                <strong class="fragment roll-in">conventions.ignored</strong>
                            </li>
                            <li>
                                le dossier <em>«&nbsp;public&nbsp;»</em> est le dossier cible où tout va aller
                                <strong class="fragment roll-in">paths.public</strong>
                            </li>
                        </ul>
                        <p class="fragment roll-in"><span class="fragment highlight-red">Entièrement modifiable via brunch-config.(coffee|js)</span></p>
                    </section>
                    <section data-transition="slide" data-background="#b5533c" data-background-transition="zoom">
                        <h2>Voyons voir notre config</h2>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
module.exports = config:
  files:
    javascripts: joinTo:
      'libraries.js': /^vendor/
      'app.js': /^app/
    stylesheets: joinTo: 'app.css'
                        </code></pre>
                    </section>
                    <section data-transition="slide" data-background="#4d7e65" data-background-transition="zoom">
                        <h2>Voyons voir notre config</h2>
                        <pre><code data-trim contenteditable>
module.exports = config:
  files:
    javascripts: joinTo:
      'libraries.js': /^vendor/
      'app.js': /^app/
    stylesheets: joinTo: 'app.css'
  watcher: usePolling: true
                        </code></pre>
                    </section>
                    <section data-transition="slide" data-background="#b5533c" data-background-transition="zoom">
                        <h2>Voyons voir notre config</h2>
                        <pre><code data-trim contenteditable>
module.exports = config:
  files:
    javascripts: joinTo:
      'libraries.js': /^vendor/
      'app.js': /^app/
    stylesheets: joinTo: 'app.css'
  watcher: usePolling: true
  modules:
    wrapper: false
    definition: false
                        </code></pre>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>C'est tout pour notre VZ</h2>
                        <p class="fragment roll-in">Merci beaucoup !</p>
                        <p class="fragment roll-in">Bon allons un peu plus loin</p>
                    </section>
                    <section>
                        <h2>Mettre un fichier à part</h2>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
module.exports = config:
  files:
    javascripts: joinTo:
      'libraries.js': /^app[\\\/]jquery\.js/
      'app.js': /^(?!app[\\\/]jquery\.js)/
    stylesheets: joinTo: 'app.css'
                        </code></pre>
                        <h3 class="fragment roll-in">Pro tips</h3>
                        <p class="fragment roll-in">Ne pas le mettre dans app (tout simplement)</p>
                    </section>
                    <section>
                        <h2>On organise comme on veut</h2>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
module.exports = config:
  files:
    javascripts: joinTo:
      'bowerizer.js': /^bower_components/
      'libraries.js': /^vendor/
      'app.js': /^app/
    stylesheets: joinTo: 'app.css'
                        </code></pre>
                        <h3 class="fragment roll-in">Pro tips</h3>
                        <p class="fragment roll-in">
                            «&nbsp;4-5 ingrédients dans l'assiette, plus je laisse tomber c'est trop compliqué !&nbsp;»
                            - Adrien Demametz, Lille, 02/04/2015
                        </p>
                    </section>
                    <section>
                        <h2>Un petit coup de template</h2>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
module.exports = config:
  files:
    javascripts: joinTo:
      'libraries.js': /^vendor/
      'app.js': /^app/
    stylesheets: joinTo: 'app.css'
    templates: joinTo: 'app.js'
                        </code></pre>
                        <h3 class="fragment roll-in">Pro tips</h3>
                        <p class="fragment roll-in">«&nbsp;Remarquez les deux <strong>joinTo: 'app.js'</strong>&nbsp;»</p>
                    </section>
                    <section>
                        <h2>Wombo Combo ! Accrochez-vous !</h2>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
exports.config = {
    "paths": {
        "watched": ["dev"],
        "public": "public"
    },
    "files": {
        "stylesheets": {
            "joinTo": "css/app.min.css",
            "order": {
                "before": ["dev/css/style.css"]
            }
        },
        "javascripts": {
            "joinTo": "js/app.min.js"
        }
    },
    "conventions": {
        "assets": /static[\\/]/
    },
    "plugins": {
        "imageoptimizer": {
            "smushit": true,
            "path": "images/"
        }
    },
    "modules": {
        "wrapper": false,
        "definition": false
    }
}                        </code></pre>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Encore plus loin</h2>
                        <h3>Encore plus concret</h3>
                    </section>
                    <section>
                        <h2>Adapter un projet existant</h2>
                        <h3>Quels sont les langages</h3>
                        <p class="fragment roll-in">Définit les plugins présent dans package.json</p>
                        <h3>Où sont les sources ?</h3>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
paths.watched: ['app', 'test', 'vendor']
conventions.assets: 'assets'
conventions.vendor: 'vendor'
                        </code></pre>
                        <h3>Quel destination ?</h3>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
paths.public: 'public'
                        </code></pre>
                    </section>
                    <section>
                        <h2>Adapter un projet existant</h2>
                        <h3>Quelles règles pour les fichiers</h3>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
  files:
    javascripts: joinTo:
      'libraries.js': /^vendor/
      'app.js': /^app/
    stylesheets: joinTo: 'app.css'
    templates: joinTo: 'app.js'
                        </code></pre>
                        <p class="fragment roll-in">String, expression rationnelle, fonction prédicat, tableau</p>
                    </section>
                    <section>
                        <h2>En bonus</h2>
                        <pre><code data-trim contenteditable>
modules:
  nameCleaner: (path) ->
    path
      # Strip app/ and app/externals/ prefixes
      .replace /^app\/(?:externals\/)?/, ''
      # Allow -x.y[.z…] version suffixes in mantisses
      .replace /-\d+(?:\.\d+)+/, ''
      # Allow -fr lang suffixes in mantisses
      .replace '-fr.', '.'
                        </code></pre>
                        <p>jquery-1.11.2-min.js devient jquery.js</p>
                        <p>moment-2.2.1-fr.js devient moment.js</p>
                    </section>
                    <section>
                        <h2>Les environnements</h2>
                        <pre><code data-trim contenteditable>
brunch watch -P
brunch watch --env production
brunch watch --env karafun
                        </code></pre>
                        <pre class="fragment roll-in"><code data-trim contenteditable>
overrides:
  production:
    optimize: true
    sourceMaps: false
    plugins: autoReload: enabled: false
                        </code></pre>
                    </section>
                </section>

                <section>
                <section>
                    <h2>Ce dont on ne parle pas :(</h2>
                    <ul>
                        <li>les perf de fou</li>
                        <li>le serveur statique</li>
                        <li>le live reload</li>
                        <li>le générateur de sprite</li>
                        <li>les squelettes</li>
                        <li>les templates</li>
                        <li>le workflow de dév</li>
                        <li>le traitement des images</li>
                    </ul>
                </section>
                <section>
                    <h2>Toujours plus</h2>
                    <ul>
                        <li>https://github.com/brunch/brunch/blob/master/docs/config.md</li>
                    </ul>
                </section>
                </section>

            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>
        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,
                transition: 'convex', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    {src: 'lib/js/classList.js', condition: function() {
                            return
                            !document.body.classList;
                        }},
                    {src: 'plugin/markdown/marked.js', condition: function() {
                            return
                            !!document.querySelector('[data-markdown]');
                        }},
                    {src: 'plugin/markdown/markdown.js', condition: function() {
                            return !!document.querySelector('[data-markdown]');
                        }},
                    {src: 'plugin/highlight/highlight.js', async: true, condition:
                                function() {
                                    return !!document.querySelector('pre code');
                                }, callback:
                                function() {
                                    hljs.initHighlightingOnLoad();
                                }},
                    {src: 'plugin/zoom-js/zoom.js', async: true},
                    {src: 'plugin/notes/notes.js', async: true}
                ]
            });
        </script>
    </body>
</html>
